---
title: "Practice Worksheet: Gerrymandering"
format: typst
---

Recall the 3 quantitative approaches to measuring gerrymandering discussed in lecture:\
1. Mean - Median Score (Grofman, 1983)\
2. Efficiency Gap (Stephanopolous and McGee, 2015)\
3. Ensembles / Extreme Outliers\
Use the following table to practice applying the first two techniques.\

| District | D Votes | R Votes | Result  |
|:---------:|:-------:|:-------:|:--------|
| 1 | 62 | 38 | D wins |
| 2 | 55 | 45 | D wins |
| 3 | 44 | 56 | R wins |
| 4 | 47 | 53 | R wins |
| 5 | 46 | 54 | R wins |
| **Total** | **254** | **246** |          |

```{r}
#| message: false
#| echo: false
library(tidyverse)
votes <- tibble(District = 1:5,
                d_votes = c(62, 55, 44, 47, 46),
                r_votes = c(38, 45, 56, 53, 54),
                result = c(rep("D wins", 2), rep("R wins", 3)))
```

### Q1. Mean-Median Score

Calculate the mean-median score associated with this particular district breakdown of votes.

```{r}
votes <- votes |>
    mutate(v_i = d_votes / (d_votes + r_votes)) |>
    summarize(mean_v = mean(v_i),
    med_v = median(v_i))|>
    mutate(mean_v - med_v)
votes
```

### Q2. Efficiency Gap

Calculate the Efficiency Gap (EG) associated with this particular district breakdown of votes.

*Tip*: it may be helpful to write a function that takes a vector of votes across districts for party A and vector of votes for the party B and returns a vector of the number votes wasted by party A across districts.


```{r}
library(tidyverse)

# Original votes tibble
votes <- tibble(
  District = 1:5,
  d_votes = c(62, 55, 44, 47, 46),
  r_votes = c(38, 45, 56, 53, 54),
  result = c(rep("D wins", 2), rep("R wins", 3))
)

EG_data <- votes |>
  mutate(
    total = .data$d_votes + .data$r_votes,
    needed_to_win = floor(total / 2) + 1,
    wasted_d = if_else(.data$d_votes > .data$r_votes, .data$d_votes - needed_to_win, .data$d_votes),
    wasted_r = if_else(.data$r_votes > .data$d_votes, .data$r_votes - needed_to_win, .data$r_votes)
  ) |>
  summarize(
    wasted_d_total = sum(wasted_d),
    wasted_r_total = sum(wasted_r),
    total_votes = sum(total)
  )

EG <- (EG_data$wasted_d_total - EG_data$wasted_r_total) / EG_data$total_votes
EG


```